zephyr_include_directories(../../include)

zephyr_library()

if (CONFIG_HUBBLE_SAT_NETWORK OR CONFIG_HUBBLE_BLE_NETWORK)
	zephyr_library_sources(hubble_zephyr.c)
	zephyr_library_sources(../../src/hubble.c)
	zephyr_library_sources(../../src/hubble_crypto.c)
	zephyr_library_sources_ifdef(CONFIG_HUBBLE_NETWORK_CRYPTO_MBEDTLS ../../src/crypto/mbedtls.c)
	zephyr_library_sources_ifdef(CONFIG_HUBBLE_NETWORK_CRYPTO_PSA ../../src/crypto/psa.c)
	if (CONFIG_HUBBLE_NETWORK_CRYPTO_PSA OR CONFIG_HUBBLE_NETWORK_CRYPTO_MBEDTLS)
		zephyr_library_link_libraries(mbedTLS)
	endif()
endif()

if(CONFIG_HUBBLE_SAT_NETWORK)
	zephyr_library_sources(../../src/utils/bitarray.c)
	zephyr_library_sources(../../src/hubble_sat_ephemeris.c)
	zephyr_library_sources(../../src/hubble_sat.c)
	zephyr_library_sources_ifdef(CONFIG_HUBBLE_SAT_NETWORK_PROTOCOL_DEPRECATED ../../src/hubble_sat_packet_deprecated.c)
	zephyr_library_sources_ifdef(CONFIG_HUBBLE_SAT_NETWORK_PROTOCOL_V1 ../../src/hubble_sat_packet.c)
	zephyr_library_sources(../../src/reed_solomon_encoder.c)
	zephyr_library_sources(hubble_sat_zephyr.c)
	zephyr_include_directories(.)
endif()


if(CONFIG_HUBBLE_BLE_NETWORK)
	zephyr_library_sources(../../src/hubble_ble.c)
endif()
